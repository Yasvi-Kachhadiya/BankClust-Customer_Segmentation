<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>BankClust: Smart Customer Segmentation</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>BankClust: Smart Customer Segmentation</h1>
            <p class="description">
                Upload your customer data CSV to automatically segment customers into 6 distinct clusters.
                View distribution, proportions, and key feature trends across clusters.
            </p>
        </header>

        <section class="upload-section">
            <form method="post" enctype="multipart/form-data">
                <label for="file">Upload Customer Data (CSV):</label>
                <input type="file" name="file" id="file" accept=".csv" required>

                {% if segments %}
                <label for="segment_filter">Filter by Segment:</label>
                <select name="segment_filter" id="segment_filter">
                    <option value="">-- All Segments --</option>
                    {% for segment in segments %}
                        <option value="{{ segment }}">{{ segment }}</option>
                    {% endfor %}
                </select>
                {% endif %}

                <button type="submit">Analyze Data</button>
            </form>

            {% if message %}
                <p class="error">{{ message }}</p>
            {% endif %}
        </section>

    

        <section class="results-section">
            {% if table %}
                <h2>Full Data with Cluster Labels & Segment Names</h2>
                <div class="table-container">{{ table|safe }}</div>
                <a href="/download" class="btn">ðŸ“¥ Download Clustered CSV</a>
            {% endif %}

            {% if dist_chart %}
                <h2>Cluster Distribution</h2>
                <img src="data:image/png;base64,{{ dist_chart }}" alt="Cluster Distribution Chart" />
                <a href="/download_chart/dist_chart.png" class="btn">ðŸ“Š Download Bar Chart </a>
            {% endif %}

            {% if pie_chart %}
                <h2>Cluster Proportions</h2>
                <img src="data:image/png;base64,{{ pie_chart }}" alt="Cluster Proportions Chart" />
                <a href="/download_chart/pie_chart.png" class="btn">ðŸ¥§ Download Pie Chart</a>
            {% endif %}

            {% if line_chart %}
                <h2>{{ stats['Top Feature'] }} Across Clusters</h2>
                <img src="data:image/png;base64,{{ line_chart }}" alt="Line Chart" />
                <p class="stat">Max Variation in '{{ stats['Top Feature'] }}': {{ stats['Max Variation'] }}</p>
                <a href="/download_chart/line_chart.png" class="btn">ðŸ“ˆ Download Line Chart</a>
            {% endif %}
        </section>
    </div>
</body>
</html>
